<!DOCTYPE html>
<html lang="mk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INet –ö–≤–∏–∑ ‚Äî –ò–∑–±–µ—Ä–∏ –≥–æ —Ç–≤–æ—ò–æ—Ç –∏–¥–µ–∞–ª–µ–Ω –ª–∞–ø—Ç–æ–ø</title>
    <meta name="description" content="–û–¥–≥–æ–≤–æ—Ä–∏ –Ω–∞ –ø—Ä–∞—à–∞—ö–∞ –∏ –¥–æ–±–∏—ò –ø—Ä–µ–ø–æ—Ä–∞–∫–∞ –æ–¥ INet –µ–∫—Å–ø–µ—Ä—Ç." />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
<!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1108820734463921');
fbq('track', 'PageView');
</script>
<noscript>
  <img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1108820734463921&ev=PageView&noscript=1"/>
</noscript>
<!-- End Meta Pixel Code -->

    <style>
        /* Base Styling */
        body {
            font-family: 'Inter', sans-serif;
            color: #1f2937;
            margin: 0;
            background: linear-gradient(135deg, #e0f2f7 0%, #d1e8ef 50%, #c1dfeb 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem;
        }

        /* Accent Colors */
        .accent-blue { color: #007bff; }
        .accent-green { color: #28a745; }
        .bg-accent-blue { background-color: #007bff; }
        .bg-accent-green { background-color: #28a745; }
        .border-accent-blue { border-color: #007bff; }
        .hover\:bg-blue-700:hover { background-color: #0056b3; }

        /* Liquid Glass Card and Panel Styling */
        .quiz-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1), 0 5px 15px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            min-height: 600px;
            display: flex;
            flex-direction: column;
            position: relative;
            transition: all 0.5s ease;
        }

        /* Option Button Styling */
        .option-card {
            transition: all 0.3s ease-out;
            border: 1px solid rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.6);
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }
        .option-card:hover {
            transform: translateY(-3px) scale(1.01);
            border-color: rgba(0, 123, 255, 0.6);
            background: rgba(230, 240, 255, 0.8);
            box-shadow: 0 6px 15px rgba(0, 123, 255, 0.15);
        }
        .option-card.selected {
            border-color: #007bff;
            background: rgba(0, 123, 255, 0.1);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.3);
        }
        .option-card.selected .icon-box {
            background-color: #007bff;
            color: white;
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.3);
        }
        
        .icon-box {
            transition: all 0.2s ease-out;
            background: rgba(229, 231, 235, 0.8);
            color: #4b5563;
            border-radius: 50%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        /* Input Styling */
        .input-field {
            border: 1px solid rgba(209, 213, 219, 0.6);
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            transition: all 0.3s ease;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        .input-field:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25), inset 0 1px 3px rgba(0,0,0,0.08);
            background: rgba(255, 255, 255, 0.9);
        }

        /* Animations */
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Progress Bar */
        .progress-bar-fill {
            transition: width 0.6s ease-out;
            background: linear-gradient(to right, #28a745, #007bff);
            border-radius: 9999px;
        }
        #progress-container {
            background: rgba(229, 231, 235, 0.5);
            border-radius: 9999px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }

        /* Disabled Button Style */
        .btn-disabled {
            background-color: rgba(209, 213, 219, 0.6) !important;
            color: #9ca3af !important;
            cursor: not-allowed !important;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1) !important;
            transform: none !important;
        }

        /* Button base style */
        .quiz-button {
            border-radius: 12px;
            background: #007bff;
            color: white;
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 6px 15px rgba(0, 123, 255, 0.25);
            border: none;
        }
        .quiz-button:hover:not(.btn-disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 123, 255, 0.35);
        }

        .cta-button-accent {
            background: linear-gradient(45deg, #007bff, #28a745);
            box-shadow: 0 8px 20px rgba(0, 123, 255, 0.3);
        }
        .cta-button-accent:hover:not(.btn-disabled) {
            background: linear-gradient(45deg, #0056b3, #1e7e34);
            box-shadow: 0 10px 25px rgba(0, 123, 255, 0.4);
        }

        /* Thank you screen elements */
        #confirmation-screen .bg-green-50 {
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid rgba(40, 167, 69, 0.3);
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(40, 167, 69, 0.1);
        }
        #confirmation-screen .text-left > div {
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 0.75rem 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

    </style>
</head>
<body>

    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WC6S5RZV"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>

    <!-- Meta Pixel (noscript) -->
    <noscript>
        <img height="1" width="1" style="display:none"
        src="https://www.facebook.com/tr?id=4558619690906145&ev=PageView&noscript=1" />
    </noscript>

    <main id="app" class="relative z-10 w-full max-w-2xl mx-auto">
        <div class="quiz-panel">
            
            <!-- Header with Centered Logo -->
            <header class="p-6 md:p-8 flex items-center justify-center relative border-b border-gray-100/50 z-20">
                <div class="flex items-center">
                    <img src="https://i.postimg.cc/rsCJg2js/inet-liogo.png" alt="INet Logo" class="h-10 md:h-12">
                </div>
            </header>

            <div id="content-area" class="flex-1 p-6 md:p-10 flex flex-col justify-center relative">
                
                <!-- START SCREEN -->
                <div id="start-screen" class="text-center flex flex-col items-center justify-center h-full fade-in absolute inset-0 z-10 p-6">
                    <div class="mb-6">
                        <i class="fa-solid fa-graduation-cap text-6xl md:text-7xl accent-blue"></i>
                    </div>
                    <h1 class="text-3xl md:text-4xl font-extrabold mb-4 tracking-tight leading-tight text-gray-800">
                        –ö–æ—ò –õ–µ–Ω–æ–≤–æ –ª–∞–ø—Ç–æ–ø –µ –∏–¥–µ–∞–ª–µ–Ω –∑–∞ —Ç–≤–æ—ò–æ—Ç —Ñ–∞–∫—É–ª—Ç–µ—Ç
                    </h1>
                    <p class="text-gray-600 text-lg mb-10 max-w-md mx-auto leading-relaxed">
                        –°—Ç–æ—Ç–∏—Ü–∏ —Å—Ç—É–¥–µ–Ω—Ç–∏ –≤–µ—ú–µ –≥–æ –Ω–∞—ò–¥–æ–∞ –∏–¥–µ–∞–ª–Ω–∏–æ—Ç –ª–∞–ø—Ç–æ–ø –∑–∞ –Ω–∏–≤ –ø—Ä–µ–∫—É –æ–≤–æ—ò –∫–≤–∏–∑. –û–¥–≥–æ–≤–æ—Ä–∏ –Ω–∞ 6 –ø—Ä–∞—à–∞—ö–∞ –∏ –Ω–∞—ò–¥–∏ –≥–æ –∏ —Ç–∏.
                    </p>
                    
                    <button onclick="quizApp.start()" class="quiz-button cta-button-accent px-10 py-4 text-lg tracking-wide">
                        –ü–û–ß–ù–ò –ö–í–ò–ó
                        <i class="fa-solid fa-arrow-right ml-2 transition-transform group-hover:translate-x-1"></i>
                    </button>
                </div>

                <!-- QUESTION SCREEN -->
                <div id="question-screen" class="hidden h-full flex-col justify-center relative z-10">
                    <div class="mb-8">
                        <div class="flex items-center gap-3 mb-3">
                            <span id="question-number" class="accent-blue text-sm font-bold border border-accent-blue px-2 py-0.5 rounded-full">1/6</span>
                            <span class="text-gray-400 text-xs font-bold uppercase tracking-widest">–ß–µ–∫–æ—Ä</span>
                        </div>
                        <h2 id="question-text" class="text-2xl md:text-3xl font-bold text-gray-800 leading-snug"></h2>
                        <p id="selection-info" class="text-sm text-gray-500 mt-2 hidden"></p>
                    </div>

                    <div id="progress-container" class="w-full h-1.5 bg-gray-200 rounded-full overflow-hidden mb-8">
                        <div id="progress-bar" class="h-full w-0 progress-bar-fill"></div>
                    </div>

                    <div id="options-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Options injected by JS -->
                    </div>
                    
                    <button id="next-btn" onclick="quizApp.nextQuestion()" class="quiz-button mt-8 py-3 text-white font-bold uppercase tracking-wider btn-disabled">
                        –°–ª–µ–¥–Ω–æ <i class="fa-solid fa-chevron-right ml-2"></i>
                    </button>
                </div>

                <!-- LEAD / CONTACT FORM SCREEN -->
                <div id="lead-form-screen" class="hidden h-full flex flex-col justify-center fade-in w-full p-2">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-800 text-center mb-2">–ö–æ—ò Lenovo e –ò–¥–µ–∞–ª–µ–Ω –ó–∞ –¢–µ–±–µ?</h2>
                    <p class="text-gray-600 text-center text-lg mb-8">–°–µ–≥–∞ —Å–∞–º–æ –æ—Å—Ç–∞–≤–∏ –∫–æ–Ω—Ç–∞–∫—Ç –∏ —ú–µ —Ç–∏ –ø—Ä–∞—Ç–∏–º–µ 1‚Äì3 Lenovo –º–æ–¥–µ–ª–∏ —à—Ç–æ –Ω–∞—ò–º–Ω–æ–≥—É —Ç–∏ –æ–¥–≥–æ–≤–∞—Ä–∞–∞—Ç.</p>
                    
                    <div class="w-full max-w-md mx-auto bg-gray-50/70 p-6 rounded-xl border border-gray-100/50 shadow-lg backdrop-blur-sm">
                        <div class="space-y-4">
                            <div>
                                <label for="contact_name" class="block text-sm font-medium text-gray-700 mb-1">–ò–º–µ –∏ –ü—Ä–µ–∑–∏–º–µ</label>
                                <input type="text" id="contact_name" class="input-field w-full p-3 rounded-lg" placeholder="–ü–µ—Ç–∞—Ä –ü–µ—Ç—Ä–æ–≤—Å–∫–∏">
                            </div>
                            <div>
                                <label for="contact_phone" class="block text-sm font-medium text-gray-700 mb-1">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                <input type="tel" id="contact_phone" class="input-field w-full p-3 rounded-lg" placeholder="+389 7X XXX XXX (–ø—Ä. +38970123456)">
                            </div>
                            <div>
                                <label for="contact_email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                <input type="email" id="contact_email" class="input-field w-full p-3 rounded-lg" placeholder="petar@example.com">
                            </div>
                            <div>
                                <label for="contact_faculty" class="block text-sm font-medium text-gray-700 mb-1">–§–∞–∫—É–ª—Ç–µ—Ç</label>
                                <input type="text" id="contact_faculty" class="input-field w-full p-3 rounded-lg" placeholder="–ü—Ä–∞–≤–µ–Ω —Ñ–∞–∫—É–ª—Ç–µ—Ç">
                            </div>
                            
                            <div class="flex items-start gap-3 pt-2">
                                <input
                                    type="checkbox"
                                    id="q_consent"
                                    required
                                    class="h-5 w-5 mt-0.5 cursor-pointer rounded border border-gray-300 text-blue-600 focus:ring-blue-500"
                                >
                                <label
                                    for="q_consent"
                                    class="text-xs text-gray-600 leading-tight cursor-pointer hover:text-gray-800 transition-colors pt-0.5"
                                >
                                    –°–µ —Å–æ–≥–ª–∞—Å—É–≤–∞–º –¥–∞ –±–∏–¥–∞–º –∫–æ–Ω—Ç–∞–∫—Ç–∏—Ä–∞–Ω –≤–æ –≤—Ä—Å–∫–∞ —Å–æ –º–æ—ò–∞—Ç–∞ –ø—Ä–µ–ø–æ—Ä–∞–∫–∞ –∏ –ø–æ–Ω—É–¥–∏.
                                </label>
                            </div>

                            <div id="form-error" class="hidden text-red-600 text-sm mt-2 font-medium bg-red-50/70 p-3 rounded border border-red-300 backdrop-blur-sm">
                                <!-- Error message injected here -->
                            </div>

                            <button id="submitBtn" onclick="quizApp.submitForm()" class="quiz-button cta-button-accent w-full mt-6 py-4">
                                üëâ –ò–ó–ë–ï–†–ò –ú–ò –õ–ê–ü–¢–û–ü
                            </button>
                        </div>
                    </div>
                </div>

                <!-- CONFIRMATION SCREEN -->
                <div id="confirmation-screen" class="hidden h-full flex flex-col items-center justify-center fade-in p-6 text-center">
                    <i class="fa-solid fa-check-circle accent-green text-7xl mb-6"></i>
                    <h2 class="text-3xl md:text-4xl font-extrabold mb-4 text-gray-800">–¢–∏ –±–ª–∞–≥–æ–¥–∞—Ä–∏–º–µ!</h2>
                    
                    <p class="text-gray-600 text-lg mb-8 max-w-lg mx-auto">
                        –ù–∞—à IT —Å–æ–≤–µ—Ç–Ω–∏–∫ —ú–µ —Ç–∏ —Å–µ —ò–∞–≤–∏ –∑–∞ –∫—Ä–∞—Ç–∫–æ –∏ —ú–µ —Ç–∏ –ø—Ä–µ–ø–æ—Ä–∞—á–∞ –Ω–∞—ò–¥–æ–±—Ä–∞ –æ–ø—Ü–∏—ò–∞ –∑–∞ —Ç–≤–æ–∏—Ç–µ –ø–æ—Ç—Ä–µ–±–∏.
                    </p>
                    <p class="text-gray-700 text-lg font-bold mb-8 max-w-lg mx-auto bg-green-50 p-4 rounded-lg border border-green-200">
                        –û–≤–∞ –µ –±–µ—Å–ø–ª–∞—Ç–Ω–∞ —É—Å–ª—É–≥–∞ –æ–¥ INet.
                    </p>

                    <div class="text-left space-y-2 mt-4 max-w-xs w-full text-sm text-gray-700">
                        <div class="flex items-center gap-2"><i class="fa-solid fa-circle-check accent-green"></i> <span class="font-semibold">27 –≥–æ–¥–∏–Ω–∏ –∏—Å–∫—É—Å—Ç–≤–æ</span></div>
                        <div class="flex items-center gap-2"><i class="fa-solid fa-circle-check accent-green"></i> <span class="font-semibold">–û–≤–ª–∞—Å—Ç–µ–Ω Lenovo –ø–∞—Ä—Ç–Ω–µ—Ä</span></div>
                        <div class="flex items-center gap-2"><i class="fa-solid fa-circle-check accent-green"></i> <span class="font-semibold">–ì–∞—Ä–∞–Ω—Ü–∏—ò–∞ –∏ —Å–µ—Ä–≤–∏—Å –≤–æ –ú–∞–∫–µ–¥–æ–Ω–∏—ò–∞</span></div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <!-- Hidden Input for UTM -->
    <input type="hidden" id="utm_source_input" value="">

    <script>
        // --- Data & Configuration ---
        const questions = [
            { 
                id: "q1",
                title: "–ó–∞ —à—Ç–æ –Ω–∞—ò—á–µ—Å—Ç–æ —ú–µ –≥–æ –∫–æ—Ä–∏—Å—Ç–∏—à?",
                type: "single",
                answers: [
                    "–§–∞–∫—É–ª—Ç–µ—Ç, Google Docs",
                    "–§–∏–ª–º–æ–≤–∏, –º—É–∑–∏–∫–∞, YouTube",
                    "–î–∏–∑–∞—ò–Ω, Photoshop, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞",
                    "–ü—Ä–æ–≥—Ä–∞–º–∏—Ä–∞—ö–µ",
                    "–ì–µ—ò–º–∏–Ω–≥",
                    "–ù–µ —Å—É–º —Å–∏–≥—É—Ä–µ–Ω, –∑–∞—Ç–æ–∞ –≥–æ –ø–æ–ø–æ–ª–Ω—É–≤–∞–º –∫–≤–∏–∑–æ—Ç"
                ]
            },
            { id: "q2", title: "–ö–æ–ª–∫—É —á–µ—Å—Ç–æ —É—á–∏—à/—Ä–∞–±–æ—Ç–∏—à –Ω–∞ –ª–∞–ø—Ç–æ–ø?", type: "single", answers: ["–°–µ–∫–æ—ò –¥–µ–Ω", "3‚Äì5 –¥–µ–Ω–∞ –Ω–µ–¥–µ–ª–Ω–æ", "–°–∞–º–æ –∫–æ–≥–∞ –∏–º–∞–º –∏—Å–ø–∏—Ç/–∫–æ–ª–æ–∫–≤–∏—É–º", "–†–µ—Ç–∫–æ"] },
            { id: "q3", title: "–ö–∞–¥–µ –Ω–∞—ò—á–µ—Å—Ç–æ –≥–æ –∫–æ—Ä–∏—Å—Ç–∏—à –ª–∞–ø—Ç–æ–ø–æ—Ç?", type: "single", answers: ["–î–æ–º–∞", "–ù–∞ —Ñ–∞–∫—É–ª—Ç–µ—Ç", "–í–æ –¥–≤–∏–∂–µ—ö–µ / –∫–∞—Ñ–∏—á–∏", "–°–µ–∫–∞–¥–µ –≥–æ –Ω–æ—Å–∞–º —Å–æ –º–µ–Ω–µ"] },
            { id: "q4", title: "–ö–∞–∫–≤–∏ –ø—Ä–æ–≥—Ä–∞–º–∏ –∫–æ—Ä–∏—Å—Ç–∏—à?", type: "multi", answers: ["Word, Excel, PowerPoint", "Photoshop, Illustrator", "AutoCAD, Revit", "VS Code, Python, Java", "Premiere Pro, DaVinci", "–ù–∏—à—Ç–æ —Ç–µ—à–∫–æ, —Å–∞–º–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç"] },
            { id: "q5", title: "–ö–∞–∫–≤–∞ –≥–æ–ª–µ–º–∏–Ω–∞ –Ω–∞ –µ–∫—Ä–∞–Ω —Ç–∏ –æ–¥–≥–æ–≤–∞—Ä–∞?", type: "single", answers: ["–ú–∞–ª –∏ –ª–µ—Å–µ–Ω (13‚Äì14‚Äù)", "–°—Ä–µ–¥–µ–Ω (15‚Äù)", "–ì–æ–ª–µ–º –µ–∫—Ä–∞–Ω (16‚Äì17‚Äù)"] },
            { id: "q6", title: "–ü—Ä–∏–±–ª–∏–∂–µ–Ω –±—É—ü–µ—Ç?", type: "single", answers: ["–î–æ 25.000 –¥–µ–Ω", "25.000‚Äì35.000 –¥–µ–Ω", "35.000‚Äì45.000 –¥–µ–Ω", "45.000+ –¥–µ–Ω", "–ù–µ —Å—É–º —Å–∏–≥—É—Ä–µ–Ω, –∑–∞—Ç–æ–∞ –≥–æ –ø—Ä–∞–≤–∞–º –∫–≤–∏–∑–æ—Ç"] }
        ];

        // Google Sheets target URL
        const googleSheetUrl = "https://script.google.com/macros/s/AKfycbwRb0f_Z2MJQw4erCKqsAF72xpO6CPgOrkvPHglTiWTiUcTaV68aZ-M_ZsyqqD4Ykd2/exec";

        // --- Logic Engine ---
        const quizApp = {
            currentStepIndex: 0,
            results: {},
            
            elements: {
                startScreen: document.getElementById('start-screen'),
                questionScreen: document.getElementById('question-screen'),
                questionText: document.getElementById('question-text'),
                questionNumber: document.getElementById('question-number'),
                optionsGrid: document.getElementById('options-grid'),
                progressBar: document.getElementById('progress-bar'),
                progressContainer: document.getElementById('progress-container'),
                nextBtn: document.getElementById('next-btn'),
                selectionInfo: document.getElementById('selection-info'),
                leadFormScreen: document.getElementById('lead-form-screen'),
                confirmationScreen: document.getElementById('confirmation-screen'),
                submitBtn: document.getElementById('submitBtn'),
                formError: document.getElementById('form-error'),
                contactName: document.getElementById('contact_name'),
                contactPhone: document.getElementById('contact_phone'),
                contactEmail: document.getElementById('contact_email'),
                contactFaculty: document.getElementById('contact_faculty'),
                consentCheckbox: document.getElementById('q_consent'),
            },

            showScreen(screenKey) {
                const screenIds = [
                    'start-screen',
                    'question-screen',
                    'lead-form-screen',
                    'confirmation-screen'
                ];

                screenIds.forEach(id => {
                    const el = document.getElementById(id);
                    if (!el) return;
                    el.classList.add('hidden');
                    el.classList.remove('fade-in', 'flex', 'flex-col');
                });

                const screen = this.elements[screenKey];
                if (screen) {
                    screen.classList.remove('hidden');
                    screen.classList.add('fade-in', 'flex', 'flex-col');
                }
            },

            start() {
                this.currentStepIndex = 0;
                this.results = {};
                this.showScreen('questionScreen');
                this.renderQuestion();
            },

            renderQuestion() {
                const currentQ = questions[this.currentStepIndex];
                if (!currentQ) return;

                this.elements.questionNumber.textContent = `${this.currentStepIndex + 1}/${questions.length}`;
                this.elements.questionText.textContent = currentQ.title;

                const progress = ((this.currentStepIndex) / questions.length) * 100;
                this.elements.progressBar.style.width = `${progress}%`;

                if (currentQ.type === 'multi') {
                    this.elements.selectionInfo.textContent = "(–ú–æ–∂–µ—à –¥–∞ –∏–∑–±–µ—Ä–µ—à –ø–æ–≤–µ—ú–µ –æ–¥–≥–æ–≤–æ—Ä–∏)";
                    this.elements.selectionInfo.classList.remove('hidden');
                } else {
                    this.elements.selectionInfo.classList.add('hidden');
                }

                this.elements.optionsGrid.innerHTML = '';
                
                if (this.results[currentQ.id] === undefined) {
                    this.results[currentQ.id] = currentQ.type === 'multi' ? [] : null;
                }

                currentQ.answers.forEach((answerText) => {
                    const isSelected = (currentQ.type === 'multi' && this.results[currentQ.id].includes(answerText)) || 
                                       (currentQ.type === 'single' && this.results[currentQ.id] === answerText);
                    
                    const iconBaseClass = currentQ.type === 'single' ? 'fa-circle' : 'fa-square';
                    const iconSelectedClass = currentQ.type === 'single' ? 'fa-circle-dot' : 'fa-square-check';

                    const selectedClass = isSelected ? 'selected' : '';
                    const iconSolidOrRegular = isSelected ? 'fa-solid' : 'fa-regular';
                    const iconTypeClass = isSelected ? iconSelectedClass : iconBaseClass;

                    const card = document.createElement('div');
                    card.className = `option-card p-4 rounded-lg cursor-pointer flex items-start gap-4 ${selectedClass}`;
                    card.setAttribute('data-answer', answerText);
                    card.onclick = () => this.toggleSelection(currentQ.id, answerText, currentQ.type);

                    card.innerHTML = `
                        <div class="icon-box w-6 h-6 flex items-center justify-center rounded-full flex-shrink-0 mt-1">
                            <i class="${iconSolidOrRegular} ${iconTypeClass} text-sm"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700 leading-relaxed">${answerText}</span>
                    `;
                    this.elements.optionsGrid.appendChild(card);
                });

                this.updateNextButtonState();
            },

            toggleSelection(qId, answerText, type) {
                let selections = this.results[qId];

                if (type === 'single') {
                    selections = (selections === answerText) ? null : answerText;
                } else if (type === 'multi') {
                    selections = selections || [];
                    const index = selections.indexOf(answerText);
                    if (index > -1) {
                        selections.splice(index, 1);
                    } else {
                        selections.push(answerText);
                    }
                }

                this.results[qId] = selections;
                this.updateOptionsUI(qId);
                this.updateNextButtonState();
            },

            updateOptionsUI(qId) {
                const currentQ = questions[this.currentStepIndex];
                const selections = currentQ.type === 'multi'
                    ? (this.results[qId] || [])
                    : (this.results[qId] ? [this.results[qId]] : []);
                
                const optionCards = this.elements.optionsGrid.querySelectorAll('.option-card');
                
                optionCards.forEach(card => {
                    const answer = card.getAttribute('data-answer');
                    const iconEl = card.querySelector('.icon-box i');
                    
                    const isSelected = selections.includes(answer);
                    const iconBaseClass = currentQ.type === 'single' ? 'fa-circle' : 'fa-square';
                    const iconSelectedClass = currentQ.type === 'single' ? 'fa-circle-dot' : 'fa-square-check';

                    iconEl.classList.remove('fa-regular', 'fa-solid', iconBaseClass, iconSelectedClass);
                    
                    if (isSelected) {
                        card.classList.add('selected');
                        iconEl.classList.add('fa-solid', iconSelectedClass);
                    } else {
                        card.classList.remove('selected');
                        iconEl.classList.add('fa-regular', iconBaseClass);
                    }
                });
            },

            updateNextButtonState() {
                const currentQ = questions[this.currentStepIndex];
                if (!currentQ) {
                    this.elements.nextBtn.classList.add('btn-disabled');
                    this.elements.nextBtn.disabled = true;
                    return;
                }

                let isAnswered;
                const result = this.results[currentQ.id];
                if (currentQ.type === 'multi') {
                    isAnswered = Array.isArray(result) && result.length > 0;
                } else {
                    isAnswered = result !== null && result !== undefined;
                }
                
                if (isAnswered) {
                    this.elements.nextBtn.classList.remove('btn-disabled');
                    this.elements.nextBtn.disabled = false;
                } else {
                    this.elements.nextBtn.classList.add('btn-disabled');
                    this.elements.nextBtn.disabled = true;
                }
            },

            nextQuestion() {
                const currentQ = questions[this.currentStepIndex];
                if (!currentQ || this.elements.nextBtn.disabled) return;

                this.currentStepIndex++;

                const progress = ((this.currentStepIndex) / questions.length) * 100;
                this.elements.progressBar.style.width = `${progress}%`;

                if (this.currentStepIndex < questions.length) {
                    this.renderQuestion();
                } else {
                    this.showScreen('leadFormScreen');
                }
            },

            getUtmSource() {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get('utm_source') || 'direct';
            },

            validateForm() {
                const { contactName, contactPhone, contactEmail, consentCheckbox, formError } = this.elements;
                let errors = [];

                if (contactName.value.trim().length < 3) errors.push("–í–Ω–µ—Å–µ—Ç–µ –ø–æ–ª–Ω–æ –ò–º–µ –∏ –ü—Ä–µ–∑–∏–º–µ.");
                const phoneRegex = /^\+?(\d[\d\s-]{7,}\d)$/; 
                if (!phoneRegex.test(contactPhone.value.trim())) errors.push("–í–Ω–µ—Å–µ—Ç–µ –≤–∞–ª–∏–¥–µ–Ω –¢–µ–ª–µ—Ñ–æ–Ω—Å–∫–∏ –±—Ä–æ—ò (–º–∏–Ω–∏–º—É–º 8 —Ü–∏—Ñ—Ä–∏).");
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(contactEmail.value.trim())) errors.push("–í–Ω–µ—Å–µ—Ç–µ –≤–∞–ª–∏–¥–Ω–∞ Email –∞–¥—Ä–µ—Å–∞.");
                if (!consentCheckbox.checked) errors.push("–ú–æ—Ä–∞ –¥–∞ —Å–µ —Å–æ–≥–ª–∞—Å–∏—Ç–µ –∑–∞ –¥–∞ –≤–µ –∫–æ–Ω—Ç–∞–∫—Ç–∏—Ä–∞–º–µ.");

                if (errors.length > 0) {
                    formError.innerHTML = errors.join('<br>');
                    formError.classList.remove('hidden');
                    return false;
                } else {
                    formError.classList.add('hidden');
                    return true;
                }
            },

            async submitForm() {
                if (!this.validateForm()) return;

                this.elements.submitBtn.disabled = true;
                this.elements.submitBtn.textContent = '–ò—Å–ø—Ä–∞—ú–∞—ö–µ...';

                const { contactName, contactPhone, contactEmail, contactFaculty } = this.elements;

                let quizSummary = {};
                questions.forEach(q => {
                    const result = this.results[q.id];
                    let value;

                    if (q.type === 'multi' && Array.isArray(result)) {
                        value = result.join('; ');
                    } else if (result !== null && result !== undefined) {
                        value = result;
                    } else {
                        value = 'N/A';
                    }

                    quizSummary[q.id] = value;
                });

                const formData = {
                    Timestamp: new Date().toISOString(),
                    Name: contactName.value.trim(),
                    Phone: contactPhone.value.trim(),
                    Email: contactEmail.value.trim(),
                    Faculty: contactFaculty.value.trim() || 'N/A',
                    ...quizSummary,
                    UTM_Source: this.getUtmSource()
                };

                const fetchWithRetry = async (url, options, retries = 3) => {
                    for (let i = 0; i < retries; i++) {
                        try {
                            const response = await fetch(url, options);
                            return response;
                        } catch (error) {
                            if (i < retries - 1) {
                                const delay = Math.pow(2, i) * 1000;
                                await new Promise(resolve => setTimeout(resolve, delay));
                            } else {
                                throw error;
                            }
                        }
                    }
                };

                try {
                    await fetchWithRetry(googleSheetUrl, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: new URLSearchParams(formData).toString()
                    });

                    this.showScreen('confirmationScreen');

                } catch (error) {
                    console.error("Submission failed (even after retries):", error);
                    this.showScreen('confirmationScreen');
                } finally {
                    this.elements.submitBtn.disabled = false;
                    this.elements.submitBtn.textContent = 'üëâ –ò–ó–ë–ï–†–ò –ú–ò –õ–ê–ü–¢–û–ü';
                }
            },

            init() {
                const utmSource = this.getUtmSource();
                document.getElementById('utm_source_input').value = utmSource;
                this.showScreen('startScreen');
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            quizApp.init();
        });
    </script>
</body>
</html>
